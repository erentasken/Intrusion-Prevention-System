version: '3.8'

services:
  attacker:
    build: ./attacker
    container_name: attacker-container
    networks:
      test-network:
        ipv4_address: 172.30.0.7
    privileged: true
    tty: true
    environment:
      - TARGET_IP=172.30.0.2
    depends_on:
      - golang-ips
    volumes:
      - ./attacker/scripts:/attack-scripts  # Mount the correct directory
  golang-ips:
    build: .
    container_name: golang-ips
    volumes:
      - .:/app
    environment:
      - AIR_WATCH_DIR=/app
    networks:
      test-network:
        ipv4_address: 172.30.0.2
    privileged: true
    tty: true
    dns:
      - 172.30.0.3  # The DNS server for this container

  dns-server:
    image: technitium/dns-server:latest  # Use technitium DNS server image
    container_name: dns-server
    networks:
      test-network:
        ipv4_address: 172.30.0.3
    restart: unless-stopped

networks:
  test-network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.30.0.0/24

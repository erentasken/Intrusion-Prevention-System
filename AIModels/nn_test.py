import tensorflow as tf
import pandas as pd
from sklearn.preprocessing import StandardScaler
import joblib
import numpy as np


# Load the trained model
model = tf.keras.models.load_model('./models/nn_model.h5')
scaler = joblib.load('./models/scaler.pkl')

# data = [6015152.000, 17, 10, 516, 331, 30.000, 102.701, 33.000, 47.482, 140.811, 4.489, 445527.889, 495988.697, 400972.333, 481800.964, 668296.444, 464963.792, 2.826, 1.663, 31.000, 84.383, 2, 2, 2, 13, 24, 0, 0.000, 0.000, 0.000, 0.000, 17, 516, 10, 331, 0.000, 1.000]
# data = [1854482.000, 3422, 3422, 0, 0, 0.000, 0.000, 0.000, 0.000, 0.000, 3690.518, 485.410, 441.307, 485.640, 445.935, 485.606, 436.631, 1846.660, 1845.259, 0.000, 0.000, 0, 3422, 3422, 0, 3422, 0, 0.000, 0.000, 0.000, 0.000, 3420, 0, 3422, 0, 0.002, 0.998]
data = [219398.000, 21, 17, 3676, 4104, 175.000, 391.838, 241.000, 420.127, 35460.670, 173.201, 11499.421, 17394.356, 11502.421, 15906.696, 13652.000, 18888.080, 95.716, 77.588, 204.000, 402.079, 0, 2, 0, 22, 37, 0, 1328.000, 2.000, 1292.000, 2.000, 21, 3676, 17, 4104, 0.000, 1.000]
# data = [1854482.000, 3422, 3422, 0, 0, 0.000, 0.000, 0.000, 0.000, 0.000, 3690.518, 485.410, 441.307, 485.640, 445.935, 485.606, 436.631, 1846.660, 1845.259, 0.000, 0.000, 0, 3422, 3422, 0, 3422, 0, 0.000, 0.000, 0.000, 0.000, 3420, 0, 3422, 0, 0.002, 0.998]

data = np.array(data).reshape(1, -1)
data = scaler.transform(data)

predictions = model.predict(data)

predictions_binary = (predictions > 0.5).astype(int)

print(predictions_binary)

